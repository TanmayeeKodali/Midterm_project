),
pneumonia_bin = ifelse(PNEUMONIA == "Yes", 1, 0)
)
# Summarize counts
pneumonia_status <- pneumonia_st %>%
group_by(age_group) %>%
summarise(
n = n(),
pneumonia_cases = sum(pneumonia_bin, na.rm = TRUE)
)
# Save table
write_csv(
pneumonia_status,
here::here("output", "tables", "Pneumonia_status.csv")
)
library(labelled)
library(gtsummary)
library(here)
library(ggplot2)
library(dplyr)
here::i_am("Midterm_project.Rmd")
data_path <- here::here("data", "covid_sub.csv")
covid <- readr::read_csv(data_path, show_col_types = FALSE)
# Create new dataset with age groups and pneumonia bin
pneumonia_st <- covid %>%
mutate(
age_group = cut(
AGE,
breaks = c(0, 19, 39, 59, 79, Inf),
labels = c("0-19", "20-39", "40-59", "60-79", "80+"),
include.lowest = TRUE
),
pneumonia_bin = ifelse(PNEUMONIA == "Yes", 1, 0)
)
# Summarize counts
pneumonia_status <- pneumonia_st %>%
group_by(age_group) %>%
summarise(
n = n(),
pneumonia_cases = sum(pneumonia_bin, na.rm = TRUE)
)
# Save table
write_csv(
pneumonia_status,
here::here("output", "tables", "Pneumonia_status.csv")
)
View(pneumonia_status)
library(labelled)
library(gtsummary)
library(here)
library(ggplot2)
library(dplyr)
library(readr)
# Create new dataset with age groups and pneumonia bin
pneumonia_st <- covid %>%
mutate(
age_group = cut(
AGE,
breaks = c(0, 19, 39, 59, 79, Inf),
labels = c("0-19", "20-39", "40-59", "60-79", "80+"),
include.lowest = TRUE
),
pneumonia_bin = ifelse(PNEUMONIA == "Yes", 1, 0)
)
# Summarize counts
pneumonia_status <- pneumonia_st %>%
group_by(age_group) %>%
summarise(
n = n(),
pneumonia_cases = sum(pneumonia_bin, na.rm = TRUE)
)
# Save table
write_csv(
pneumonia_status,
here::here("output", "tables", "Pneumonia_status.csv")
)
ggplot(pneumonia_status,
aes(x = age_group, y = pneumonia_cases)) +
geom_col(fill = "steelblue") +
labs(
title = "Pneumonia Prevalence by Age Group",
x = "Age Group",
y = "Proportion with Pneumonia"
)
ggsave(
here::here("output/figures/Pneumonia_age.png"),
plot = boxplot,
device = "png"
)
pneumonia_plot <- ggplot(pneumonia_status,
aes(x = age_group, y = pneumonia_cases)) +
geom_col(fill = "steelblue") +
labs(
title = "Pneumonia Prevalence by Age Group",
x = "Age Group",
y = "Proportion with Pneumonia"
)
ggsave(
here::here("output/figures/Pneumonia_age.png"),
plot = pneumonia_plot,
device = "png"
)
patient_type_tbl <- covid %>%
group_by(hosp_label) %>%
summarise(
n = n(),
mean_age = mean(AGE, na.rm = TRUE),
sd_age   = sd(AGE, na.rm = TRUE),
.groups = "drop"
)
covid <- covid %>%
mutate(
hospitalized = ifelse(PATIENT_TYPE == "Hospitalization", 1, 0)
)
patient_type_tbl <- covid %>%
group_by(hosp_label) %>%
summarise(
n = n(),
mean_age = mean(AGE, na.rm = TRUE),
sd_age   = sd(AGE, na.rm = TRUE),
.groups = "drop"
)
hosp_status <- covid %>%
mutate(age_group = cut(AGE,
breaks = c(0,19,39,59,79,Inf),
labels = c("0-19","20-39","40-59","60-79","80+"),
include.lowest = TRUE)) %>%
group_by(age_group) %>%
summarise(
n = n(),
hospitalized_cases = sum(hospitalized, na.rm = TRUE)
)
write_csv(hosp_status,
here::here("output", "tables", "patient_type.csv"))
ggplot(covid, aes(x = hosp_label, y = AGE)) +
geom_boxplot(fill = "steelblue", color = "black") +
labs(
title = "Age Distribution by Hospitalization Status",
x = "Hospitalization status",
y = "Age (years)"
) +
theme_minimal()
hosp_plot <- ggplot(hosp_status,
aes(x = age_group, y = hospitalized_cases)) +
geom_col(fill = "steelblue") +
labs(title = "Hospitalization by Age Group",
x = "Age Group",
y = "Number Hospitalized")
ggsave(
here::here("output/figures/PatientType_age.png"),
plot = hosp_plot,
device = "png"
)
# Create new dataset with age groups and hospitalization indicator
patient_type_st <- covid %>%
mutate(
age_group = cut(
AGE,
breaks = c(0, 19, 39, 59, 79, Inf),
labels = c("0–19", "20–39", "40–59", "60–79", "80+"),
include.lowest = TRUE
),
hospitalized = if_else(PATIENT_TYPE == 2, 1, 0)   # 2 = hospitalized
)
patient_type_tbl <- patient_type_st %>%
group_by(age_group) %>%
summarise(
n = n(),
hospitalized_cases = sum(hospitalized, na.rm = TRUE)
)
write_csv(
patient_type_tbl,
here::here("output", "tables", "patient_type.csv")
)
# Create new dataset with age groups and hospitalization indicator
patient_type_st <- covid %>%
mutate(
age_group = cut(
AGE,
breaks = c(0, 19, 39, 59, 79, Inf),
labels = c("0–19", "20–39", "40–59", "60–79", "80+"),
include.lowest = TRUE
),
hospitalized = if_else(PATIENT_TYPE == 2, 1, 0)   # 2 = hospitalized
)
patient_type_tbl <- patient_type_st %>%
group_by(age_group) %>%
summarise(
n = n(),
hospitalized_cases = sum(hospitalized, na.rm = TRUE)
)
write_csv(
patient_type_tbl,
here::here("output", "tables", "patient_type.csv")
)
# Create new dataset with age groups and hospitalization indicator
patient_type_st <- covid %>%
mutate(
age_group = cut(
AGE,
breaks = c(0, 19, 39, 59, 79, Inf),
labels = c("0–19", "20–39", "40–59", "60–79", "80+"),
include.lowest = TRUE
),
hospitalized = if_else(PATIENT_TYPE == 2, 1, 0)   # 2 = hospitalized
)
patient_type_tbl <- patient_type_st %>%
group_by(age_group) %>%
summarise(
n = n(),
hospitalized_cases = sum(hospitalized, na.rm = TRUE)
)
write_csv(
patient_type_tbl,
here::here("output", "tables", "patient_type.csv")
)
covid <- covid %>%
mutate(hospitalized = if_else(PATIENT_TYPE == 2, 1, 0))
patient_type_tbl <- covid %>%
mutate(age_group = cut(AGE,
breaks = c(0, 19, 39, 59, 79, Inf),
labels = c("0–19", "20–39", "40–59", "60–79", "80+"),
include.lowest = TRUE)) %>%
group_by(age_group) %>%
summarise(
n = n(),
hospitalized_cases = sum(hospitalized, na.rm = TRUE),
rate = hospitalized_cases / n
)
write_csv(patient_type_tbl,
here::here("output", "tables", "patient_type.csv"))
covid <- covid %>%
mutate(hospitalized = if_else(PATIENT_TYPE == 2, 1, 0))
patient_type_tbl <- covid %>%
mutate(age_group = cut(AGE,
breaks = c(0, 19, 39, 59, 79, Inf),
labels = c("0–19", "20–39", "40–59", "60–79", "80+"),
include.lowest = TRUE)) %>%
group_by(age_group) %>%
summarise(
n = n(),
hospitalized_cases = sum(hospitalized, na.rm = TRUE),
rate = hospitalized_cases / n
)
write_csv(patient_type_tbl,
here::here("output", "tables", "patient_type.csv"))
covid <- covid %>%
mutate(hospitalized = if_else(PATIENT_TYPE == 2, 1, 0))
patient_type_tbl <- covid %>%
mutate(age_group = cut(AGE,
breaks = c(0, 19, 39, 59, 79, Inf),
labels = c("0–19", "20–39", "40–59", "60–79", "80+"),
include.lowest = TRUE)) %>%
group_by(age_group) %>%
summarise(
n = n(),
hospitalized_cases = sum(hospitalized, na.rm = TRUE),
rate = hospitalized_cases / n
)
write_csv(patient_type_tbl,
here::here("output", "tables", "patient_type.csv"))
covid <- covid %>%
mutate(hospitalized = if_else(PATIENT_TYPE == 2, 1, 0))
patient_type_tbl <- covid %>%
mutate(age_group = cut(AGE,
breaks = c(0, 19, 39, 59, 79, Inf),
labels = c("0–19", "20–39", "40–59", "60–79", "80+"),
include.lowest = TRUE)) %>%
group_by(age_group) %>%
summarise(
n = n(),
hospitalized_cases = sum(hospitalized, na.rm = TRUE),
rate = hospitalized_cases / n
)
write_csv(patient_type_tbl,
here::here("output", "tables", "patient_type.csv"))
covid <- covid %>%
mutate(hospitalization = if_else(PATIENT_TYPE == 2, 1, 0))
patient_type_tbl <- covid %>%
mutate(age_group = cut(AGE,
breaks = c(0, 19, 39, 59, 79, Inf),
labels = c("0–19", "20–39", "40–59", "60–79", "80+"),
include.lowest = TRUE)) %>%
group_by(age_group) %>%
summarise(
n = n(),
hospitalized_cases = sum(hospitalized, na.rm = TRUE),
rate = hospitalized_cases / n
)
write_csv(patient_type_tbl,
here::here("output", "tables", "patient_type.csv"))
covid <- covid %>%
mutate(hospitalization = if_else(PATIENT_TYPE == 2, 1, 0))
patient_type_tbl <- covid %>%
mutate(age_group = cut(AGE,
breaks = c(0, 19, 39, 59, 79, Inf),
labels = c("0–19", "20–39", "40–59", "60–79", "80+"),
include.lowest = TRUE)) %>%
group_by(age_group) %>%
summarise(
n = n(),
hospitalized_cases = sum(hospitalized, na.rm = TRUE),
rate = hospitalized_cases / n
)
write_csv(patient_type_tbl,
here::here("output", "tables", "patient_type.csv"))
covid$Hospitalization <- ifelse(covid$PATIENT_TYPE ==0, "returned home", "hospitalization")
patient_type_tbl <- covid %>%
mutate(age_group = cut(AGE,
breaks = c(0, 19, 39, 59, 79, Inf),
labels = c("0–19", "20–39", "40–59", "60–79", "80+"),
include.lowest = TRUE)) %>%
group_by(age_group) %>%
summarise(
n = n(),
hospitalized_cases = sum(hospitalized, na.rm = TRUE),
rate = hospitalized_cases / n
)
write_csv(patient_type_tbl,
here::here("output", "tables", "patient_type.csv"))
covid <- covid %>%
mutate(
hospitalized = if_else(PATIENT_TYPE == "hospitalization", 1, 0)
)
patient_type_tbl <- covid %>%
mutate(
age_group = cut(
AGE,
breaks = c(0, 19, 39, 59, 79, Inf),
labels = c("0–19", "20–39", "40–59", "60–79", "80+"),
include.lowest = TRUE
)
) %>%
group_by(age_group) %>%
summarise(
n = n(),
hospitalized_cases = sum(hospitalized, na.rm = TRUE),
rate = hospitalized_cases / n
)
write_csv(patient_type_tbl,
here::here("output", "tables", "patient_type.csv"))
hosp_plot <- ggplot(patient_type_tbl,
aes(x = age_group, y = hospitalized_cases)) +
geom_col(fill = "steelblue") +
labs(
title = "Hospitalization by Age Group",
x = "Age Group",
y = "Number Hospitalized"
)
ggsave(
here::here("output/figures/PatientType_age.png"),
plot = hosp_plot,
device = "png"
)
pneumonia_plot <- ggplot(pneumonia_status,
aes(x = age_group, y = pneumonia_cases)) +
geom_bar(fill = "steelblue") +
labs(
title = "Pneumonia Prevalence by Age Group",
x = "Age Group",
y = "Proportion with Pneumonia"
)
ggsave(
here::here("output/figures/Pneumonia_age.png"),
plot = pneumonia_plot,
device = "png"
)
library(labelled)
library(gtsummary)
library(here)
library(ggplot2)
library(dplyr)
library(readr)
here::i_am("Midterm_project.Rmd")
data_path <- here::here("data", "covid_sub.csv")
covid <- readr::read_csv(data_path, show_col_types = FALSE)
# Create new dataset with age groups and pneumonia bin
pneumonia_st <- covid %>%
mutate(
age_group = cut(
AGE,
breaks = c(0, 19, 39, 59, 79, Inf),
labels = c("0-19", "20-39", "40-59", "60-79", "80+"),
include.lowest = TRUE
),
pneumonia_bin = ifelse(PNEUMONIA == "Yes", 1, 0)
)
# Summarize counts
pneumonia_status <- pneumonia_st %>%
group_by(age_group) %>%
summarise(
n = n(),
pneumonia_cases = sum(pneumonia_bin, na.rm = TRUE)
)
# Save table
write_csv(
pneumonia_status,
here::here("output", "tables", "Pneumonia_status.csv")
)
pneumonia_plot <- ggplot(pneumonia_status,
aes(x = age_group, y = pneumonia_cases)) +
geom_bar(fill = "steelblue") +
labs(
title = "Pneumonia Prevalence by Age Group",
x = "Age Group",
y = "Proportion with Pneumonia"
)
ggsave(
here::here("output/figures/Pneumonia_age.png"),
plot = pneumonia_plot,
device = "png"
)
pneumonia_plot <- ggplot(pneumonia_status,
aes(x = age_group, y = pneumonia_cases)) +
geom_col(fill = "steelblue") +
labs(
title = "Pneumonia Prevalence by Age Group",
x = "Age Group",
y = "Proportion with Pneumonia"
)
ggsave(
here::here("output/figures/Pneumonia_age.png"),
plot = pneumonia_plot,
device = "png"
)
saveRDS(
patient_type_tbl,
file = here::here("output/tables/patient_type.rds")
)
here::i_am("code/Pneumonia_Pttype.R")
#load library
library(labelled)
library(gtsummary)
library(here)
library(ggplot2)
library(dplyr)
library(readr)
#Read data
data_path <- here::here("data", "covid_sub.csv")
covid <- readr::read_csv(data_path, show_col_types = FALSE)
# Create new dataset with age groups and pneumonia_bin
pneumonia_st <- covid %>%
mutate(
age_group = cut(
AGE,
breaks = c(0, 19, 39, 59, 79, Inf),
labels = c("0-19", "20-39", "40-59", "60-79", "80+"),
include.lowest = TRUE
),
pneumonia_bin = ifelse(PNEUMONIA == "Yes", 1, 0)
)
# Summarize counts
pneumonia_status <- pneumonia_st %>%
group_by(age_group) %>%
summarise(
n = n(),
pneumonia_cases = sum(pneumonia_bin, na.rm = TRUE)
)
# Save table
saveRDS(
pneumonia_status,
file = here::here("output/tables/Pneumonia_status.rds")
)
pneumonia_plot <- ggplot(pneumonia_status,
aes(x = age_group, y = pneumonia_cases)) +
geom_col(fill = "steelblue") +
labs(
title = "Pneumonia Prevalence by Age Group",
x = "Age Group",
y = "Proportion with Pneumonia"
)
ggsave(
here::here("output/figures/Pneumonia_age.png"),
plot = pneumonia_plot,
device = "png"
)
covid <- covid %>%
mutate(
hospitalized = if_else(PATIENT_TYPE == "hospitalization", 1, 0)
)
patient_type_tbl <- covid %>%
mutate(
age_group = cut(
AGE,
breaks = c(0, 19, 39, 59, 79, Inf),
labels = c("0–19", "20–39", "40–59", "60–79", "80+"),
include.lowest = TRUE
)
) %>%
group_by(age_group) %>%
summarise(
n = n(),
hospitalized_cases = sum(hospitalized, na.rm = TRUE),
rate = hospitalized_cases / n
)
saveRDS(
patient_type_tbl,
file = here::here("output/tables/patient_type.rds")
)
hosp_plot <- ggplot(patient_type_tbl,
aes(x = age_group, y = hospitalized_cases)) +
geom_col(fill = "steelblue") +
labs(
title = "Hospitalization by Age Group",
x = "Age Group",
y = "Number Hospitalized"
)
ggsave(
here::here("output/figures/PatientType_age.png"),
plot = hosp_plot,
device = "png"
)
